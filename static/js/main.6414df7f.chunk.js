(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{158:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),i=a(11),r=a.n(i),s=a(213),o=a(23),l=a(12),j=a(31),d=a(25),b=a(217),h=a(215),p=a(202),u=a(198),m=a(220),O=a(67),x=a(197),g=a(203),f=a(204),v=a(199),y=a(160),C=a(205),w=a(206),S=a(216),N=a(201),k=a(5),L=a(47),z=a.n(L),I=a(77),T=a.n(I),B=a(101),F=a.n(B),W=a(102),H=a.n(W),U=a.p+"static/media/CSP.59a53c23.png",R=a(42),Z=a.n(R),E=a(99),V=a(2);Z.a.workerClass=E.a,Z.a.accessToken="pk.eyJ1IjoibmVlZHNzb3lzYXVjZSIsImEiOiJja2RyYzBrNjUxZW01MnJta3V1YXN0eXAyIn0.opUlsiw-E89nF-NHh54QkA";var A=function(e){var t=e.classes,a=e.data,c=e.type,i=e.center,r=e.zoom,s=Object(n.useRef)();return Object(n.useEffect)((function(){var e=new Z.a.Map({container:s.current,style:"mapbox://styles/mapbox/streets-v11",center:i,zoom:r});return e.addControl(new Z.a.NavigationControl),e.addControl(new Z.a.ScaleControl),e.addControl(new Z.a.GeolocateControl({positionOptions:{enableHighAccuracy:!0}})),e.on("load",(function(){e.addSource("heatmap-data",{type:c,data:a}),e.addLayer({id:"trees-heat",type:"heatmap",source:"heatmap-data",maxzoom:15,paint:{"heatmap-weight":{property:"severity",type:"exponential",stops:[[0,0],[.1,.2],[.2,.4],[.4,.8],[.8,1.6],[1,3.2]]},"heatmap-intensity":{stops:[[11,1],[15,1]]},"heatmap-radius":{stops:[[11,40],[15,100],[30,250]]},"heatmap-opacity":{default:1,stops:[[14,.8],[20,0]]}}},"waterway-label"),e.addLayer({id:"trees-point",type:"circle",source:"heatmap-data",minzoom:14,paint:{"circle-radius":{property:"severity",type:"exponential",stops:[[{zoom:15,value:1},5],[{zoom:15,value:62},10],[{zoom:22,value:1},20],[{zoom:22,value:62},50]]},"circle-color":{property:"severity",type:"exponential",stops:[[0,"rgba(236,222,239,0)"],[10,"rgb(236,222,239)"],[20,"rgb(208,209,230)"],[30,"rgb(166,189,219)"],[40,"rgb(103,169,207)"],[50,"rgb(28,144,153)"],[60,"rgb(1,108,89)"]]},"circle-stroke-color":"white","circle-stroke-width":1,"circle-opacity":{stops:[[14,0],[15,1]]}}},"waterway-label")})),function(){return e.remove()}}),[i,a,c,r]),Object(V.jsx)(h.a,{className:t.mapContainer,ref:s})};A.defaultProps={type:"geojson",center:[174.80559255221152,-36.9288161777414],zoom:10};var P=Object(n.memo)(Object(k.a)({mapContainer:{height:"100%",width:"100%"}})(A)),_=a(214),J=a(200),M=function(e){var t=e.label,a=e.id,n=e.value,c=e.onChange,i=e.array;return Object(V.jsx)(x.a,{item:!0,xs:!0,children:Object(V.jsx)(_.a,{id:a,select:!0,label:t,value:n,onChange:c,fullWidth:!0,children:i.map((function(e){return Object(V.jsx)(J.a,{value:e,children:e},e)}))})})},D=a(218),X=a(219),Y=function(e){var t=e.className,a=e.label,n=e.max,c=e.min,i=e.defaultValue,r=e.step,s=e.value,o=e.onChange,l=e.onChangeCommitted;return Object(V.jsxs)(x.a,{item:!0,xs:!0,children:[Object(V.jsx)(D.a,{className:t,children:a}),Object(V.jsx)(X.a,{defaultValue:i,step:r,min:c,max:n,marks:[{value:c,label:c},{value:n,label:n}],valueLabelDisplay:"auto",value:s,onChange:o,onChangeCommitted:l})]})},G=Object(N.a)((function(e){return{map:{height:"100vh",width:"100vw"},controls:{position:"fixed",top:e.spacing(2),left:e.spacing(2),minWidth:"200px"},cardTitle:{margin:e.spacing(1)},sliderLabel:{fontSize:13,marginTop:e.spacing(1)},logoButton:{position:"absolute",width:100,height:100,bottom:e.spacing(4),right:e.spacing(2),borderRadius:50,background:"white"}}})),$=Object(k.a)({root:{border:"1px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},content:{"&$expanded":{margin:"12px 0"}},expanded:{}})(b.a),Q={Fine:"F","Light rain":"LR","Heavy rain":"HR"},q={"Bright sun":"1.0",Dark:"0.0","In-between":"0.5"},K=Object.keys(Q),ee=Object.keys(q),te=Object(n.memo)((function(e){var t=e.classes,a=e.weather,c=e.handleWeatherChange,i=e.lighting,r=e.handleLightingChange,s=e.speedLimit,j=e.handleSpeedLimitChange,b=e.handleIlluminationChangeCommited,p=Object(n.useState)("panel1"),u=Object(d.a)(p,2),S=u[0],N=u[1],k=Object(l.f)(),L=function(e){return function(t,a){N(!!a&&e)}};return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)($,{expanded:"panel1"===S,onChange:L("panel1"),children:[Object(V.jsx)(m.a,{expandIcon:Object(V.jsx)(T.a,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:Object(V.jsx)(O.a,{className:t.cardTitle,variant:"h6",children:"Crash Severity"})}),Object(V.jsx)(h.a,{px:4,children:Object(V.jsxs)(x.a,{container:!0,spacing:2,direction:"column",children:[Object(V.jsx)(M,{label:"Weather",id:"weather-selector",value:a,onChange:c,array:K}),Object(V.jsx)(M,{label:"Lighting",id:"lighting-selector",value:i,onChange:r,array:ee}),Object(V.jsx)(Y,{className:t.sliderLabel,label:"Speed (km/h)",id:"speed-selector",max:100,min:50,defaultValue:50,step:50,value:s,onChange:j,onChangeCommitted:b}),Object(V.jsx)(g.a,{style:{margin:10}}),Object(V.jsxs)(x.a,{style:{maxWidth:300},children:[Object(V.jsx)(O.a,{children:"Upload your own 500x500 image to predict crash severity"}),Object(V.jsx)("br",{}),Object(V.jsxs)("form",{children:[Object(V.jsx)("input",{accept:"image/*",className:t.input,style:{display:"none"},id:"raised-button-file",multiple:!0,type:"file",onChange:function(e){var t=e.target.files[0],a=new FormData;a.append("file",t);z.a.post("".concat("https://api.severity.ml","/upload"),a,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){k.push("/upload?file=".concat(e.data.filename))})).catch((function(e){alert("Upload Error: ".concat(e)),console.log(e)}))}}),Object(V.jsx)("label",{htmlFor:"raised-button-file",children:Object(V.jsx)("center",{children:Object(V.jsx)(f.a,{variant:"contained",component:"span",color:"primary",children:"Upload"})})})]}),Object(V.jsx)("br",{})]}),Object(V.jsx)("br",{})]})})]}),Object(V.jsxs)($,{expanded:"panel2"===S,onChange:L("panel2"),children:[Object(V.jsx)(m.a,{expandIcon:Object(V.jsx)(T.a,{}),"aria-controls":"panel2a-content",id:"panel2a-header",children:Object(V.jsx)(O.a,{className:t.cardTitle,variant:"h6",children:"More"})}),Object(V.jsxs)(v.a,{children:[Object(V.jsxs)(y.a,{button:!0,component:o.b,to:"/history",children:[Object(V.jsx)(C.a,{children:Object(V.jsx)(F.a,{})}),Object(V.jsx)(w.a,{primary:"Upload History"})]},"Upload History"),Object(V.jsxs)(y.a,{button:!0,component:o.b,to:"/about",children:[Object(V.jsx)(C.a,{children:Object(V.jsx)(H.a,{})}),Object(V.jsx)(w.a,{primary:"About SoySauceNZ"})]},"About us")]})]})]})})),ae=Object(n.memo)((function(e){var t=e.className,a=c.a.useState(null),n=Object(d.a)(a,2),i=n[0],r=n[1],s=Boolean(i),l=s?"simple-popover":void 0;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(f.a,{"aria-describedby":l,variant:"contained",className:t,onClick:function(e){r(e.currentTarget)},children:Object(V.jsx)("img",{alt:"CSP",src:U,style:{height:60,width:60}})}),Object(V.jsx)(S.a,{id:l,open:s,anchorEl:i,onClose:function(){r(null)},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"center"},children:Object(V.jsxs)(p.a,{style:{margin:10},children:[Object(V.jsxs)(O.a,{children:["v0.0.1 alpha."," ",Object(V.jsx)(o.b,{target:"_blank",to:"//github.com/SoySauceNZ",children:"SoySauseNZ"})," ","2021"]}),Object(V.jsx)(g.a,{}),Object(V.jsxs)(O.a,{children:["Based on Maxar satelite images and"," ",Object(V.jsx)(o.b,{children:"CAS Open Data"})]}),Object(V.jsx)(O.a,{children:Object(V.jsx)(o.b,{target:"_blank",to:"//www.mbie.govt.nz/science-and-technology/science-and-innovation/international-opportunities/new-zealand-r-d/innovative-partnerships/takiwaehere-the-geospatial-hackathon/",children:"TakiWaehere \u2013 NZ Geospatial Hackathon"})})]})})]})})),ne=function(){var e=G(),t=Object(n.useState)({weather:K[0],lighting:ee[0],speedLimit:50,data:"https://raw.githubusercontent.com/SoySauceNZ/geojson/main/F_0.0_100.geojson"}),a=Object(d.a)(t,2),c=a[0],i=a[1],r=function(){var e=Q[c.weather],t=q[c.lighting],a="".concat(e,"_").concat(t,"_").concat(c.speedLimit);return"".concat("https://raw.githubusercontent.com/SoySauceNZ/geojson/main","/").concat(a,".geojson")};return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(h.a,{className:e.map,children:Object(V.jsx)(P,{data:c.data})}),Object(V.jsxs)(p.a,{maxWidth:"sm",children:[Object(V.jsx)(u.a,{elevation:12,className:e.controls,children:Object(V.jsx)(te,{classes:e,weather:c.weather,handleWeatherChange:function(e){i((function(t){return Object(j.a)(Object(j.a)({},t),{},{weather:e.target.value,data:r()})}))},lighting:c.lighting,handleLightingChange:function(e){i((function(t){return Object(j.a)(Object(j.a)({},t),{},{lighting:e.target.value,data:r()})}))},speedLimit:c.speedLimit,handleSpeedLimitChange:function(e,t){i((function(e){return Object(j.a)(Object(j.a)({},e),{},{speedLimit:t})}))},handleIlluminationChangeCommited:function(e,t){i((function(e){return Object(j.a)(Object(j.a)({},e),{},{speedLimit:t,data:r()})}))}})}),Object(V.jsx)(ae,{className:e.logoButton})]})]})},ce=a(208),ie=a(212),re=a(211),se=a(207),oe=a(209),le=a(210),je=a.p+"static/media/191.7f070291.png",de=Object(N.a)((function(e){return{backButton:{position:"fixed",width:100,height:100,bottom:e.spacing(4),right:e.spacing(2),borderRadius:50,background:"white"}}})),be=function(){var e=de();return Object(V.jsx)(f.a,{component:o.b,to:"/",variant:"contained",className:e.backButton,children:Object(V.jsx)("img",{alt:"CSP",src:U,style:{height:60,width:60}})})},he={"Non-Injury Crash":"0.0","Minor Crash":"0.33","Serious Crash":"0.66","Fatal Crash":"1.0"},pe=Object.keys(Q),ue=Object(k.a)((function(e){return{cardTitle:{marginTop:e.spacing(1)},sliderLabel:{fontSize:12,marginTop:e.spacing(2)},options:{padding:e.spacing(4)}}}))((function(e){var t=e.classes,a=Object(n.useState)(pe[0]),c=Object(d.a)(a,2),i=c[0],r=c[1],s=Object(n.useState)(.5),o=Object(d.a)(s,2),j=o[0],b=o[1],p=Object(n.useState)(50),m=Object(d.a)(p,2),g=m[0],f=m[1],v=Object(n.useState)(null),y=Object(d.a)(v,2),C=y[0],w=y[1],S=new URLSearchParams(Object(l.g)().search);Object(n.useEffect)((function(){z.a.post("".concat("https://api.severity.ml","/predict"),{filename:S.get("file"),weather:Q[i],brightness:j,speed:g}).then((function(e){w(e.data.severity)})).catch((function(e){alert("Prediction: ".concat(e)),console.log(e)}))}),[i,j,g,S]);var N=function(e,t){};return Object(V.jsxs)(x.a,{container:!0,children:[Object(V.jsx)(x.a,{item:!0,xs:12,sm:6,children:Object(V.jsx)("img",{alt:"uploaded",src:je,style:{background:"black",width:"100%",height:"auto",borderRadius:10,margin:10}})}),Object(V.jsxs)(x.a,{className:t.options,item:!0,xs:12,sm:6,children:[Object(V.jsx)(O.a,{className:t.cardTitle,variant:"h5",children:"Crash Severity"}),Object(V.jsx)("br",{}),Object(V.jsx)(M,{label:"Weather",id:"weather-selector",value:i,onChange:function(e){r(e.target.value)},array:pe}),Object(V.jsx)("br",{}),Object(V.jsx)(Y,{className:t.sliderLabel,label:"Lighting",id:"lighting-selector",max:1,min:0,defaultValue:.5,step:.1,value:j,onChange:function(e,t){b(t)},onChangeCommitted:N}),Object(V.jsx)("br",{}),Object(V.jsx)(Y,{className:t.sliderLabel,label:"Speed (km/h)",id:"speed-selector",max:100,min:0,defaultValue:50,step:10,value:g,onChange:function(e,t){f(t)},onChangeCommitted:N}),Object(V.jsxs)(O.a,{className:t.cardTitle,variant:"h6",align:"center",children:["Severity: ",C]}),Object(V.jsx)(h.a,{pt:2,children:Object(V.jsx)(se.a,{component:u.a,children:Object(V.jsxs)(ce.a,{className:t.table,"aria-label":"simple table",children:[Object(V.jsx)(oe.a,{children:Object(V.jsxs)(le.a,{children:[Object(V.jsx)(re.a,{children:"Severity"}),Object(V.jsx)(re.a,{children:"Prediction"})]})}),Object(V.jsx)(ie.a,{children:Object.keys(he).map((function(e){return Object(V.jsxs)(le.a,{children:[Object(V.jsx)(re.a,{children:e}),Object(V.jsx)(re.a,{children:he[e]})]},e)}))})]})})})]}),Object(V.jsx)(be,{})]})})),me=Object(N.a)((function(e){return{cardButton:{borderRadius:10,padding:0,overflow:"hidden"},cardImage:{maxWidth:"100%",maxHeight:"100%"}}})),Oe=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=t[0],c=t[1],i=me();return Object(n.useEffect)((function(){z.a.get("".concat("https://api.severity.ml","/list")).then((function(e){c(e.data)}))}),[]),Object(V.jsxs)(p.a,{children:[Object(V.jsx)("br",{}),Object(V.jsx)(O.a,{variant:"h3",children:"Upload History"}),Object(V.jsx)("br",{}),Object(V.jsx)(g.a,{}),Object(V.jsx)("br",{}),Object(V.jsx)(x.a,{container:!0,spacing:3,children:a.map((function(e){return Object(V.jsx)(x.a,{button:!0,item:!0,xs:6,sm:3,children:Object(V.jsx)(f.a,{component:o.b,to:"/upload?file=".concat(e),className:i.cardButton,children:Object(V.jsx)("img",{alt:e,src:"".concat("https://api.severity.ml","/images/").concat(e),className:i.cardImage})})},e)}))}),Object(V.jsx)(be,{})]})},xe=function(){return Object(V.jsxs)(p.a,{children:[Object(V.jsx)("br",{}),Object(V.jsx)(O.a,{variant:"h3",children:"About Us"}),Object(V.jsx)("br",{}),Object(V.jsx)(g.a,{}),Object(V.jsx)("br",{})]})};function ge(){return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(s.a,{}),Object(V.jsx)(o.a,{children:Object(V.jsxs)(l.c,{children:[Object(V.jsx)(l.a,{path:"/upload",component:ue}),Object(V.jsx)(l.a,{path:"/history",component:Oe}),Object(V.jsx)(l.a,{path:"/about",component:xe}),Object(V.jsx)(l.a,{path:"/",component:ne})]})})]})}r.a.render(Object(V.jsx)(ge,{}),document.getElementById("root"))}},[[158,1,2]]]);
//# sourceMappingURL=main.6414df7f.chunk.js.map